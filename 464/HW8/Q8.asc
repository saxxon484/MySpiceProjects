Version 4
SHEET 1 5412 1748
WIRE -336 -400 -352 -400
WIRE -144 -400 -160 -400
WIRE -336 -384 -336 -400
WIRE -144 -384 -144 -400
WIRE -336 -288 -336 -304
WIRE -336 -288 -352 -288
WIRE -144 -288 -144 -304
WIRE -144 -288 -160 -288
WIRE -240 192 -240 176
WIRE 1232 192 1232 144
WIRE 784 208 720 208
WIRE 1840 256 1840 192
WIRE 1792 272 1776 272
WIRE -240 288 -240 272
WIRE 1232 288 1232 272
WIRE 1792 320 1776 320
WIRE 1776 352 1776 320
WIRE 1840 352 1840 336
WIRE 1840 352 1776 352
WIRE 1712 416 1680 416
WIRE 1840 416 1840 352
WIRE 1840 416 1776 416
WIRE 1840 448 1840 416
WIRE 1232 512 1232 464
WIRE 2208 528 2064 528
WIRE 2320 528 2272 528
WIRE 2352 528 2320 528
WIRE 2496 528 2432 528
WIRE 2672 528 2496 528
WIRE 1840 560 1840 528
WIRE 2064 560 2064 528
WIRE 2320 560 2320 528
WIRE 2496 560 2496 528
WIRE 2672 560 2672 528
WIRE 1232 608 1232 592
WIRE 2064 672 2064 640
WIRE 2320 672 2320 624
WIRE 2320 672 2064 672
WIRE 2496 672 2496 624
WIRE 2496 672 2320 672
WIRE 2672 672 2672 640
WIRE 2672 672 2496 672
WIRE 1712 688 1680 688
WIRE 1840 688 1840 640
WIRE 1840 688 1776 688
WIRE 2320 688 2320 672
WIRE 1840 736 1840 688
WIRE 1792 752 1776 752
WIRE 1792 800 1776 800
WIRE 1776 832 1776 800
WIRE 1840 832 1840 816
FLAG -160 -288 0
FLAG -160 -400 +VDD
FLAG 1840 192 +VDD
FLAG 1776 272 q1
FLAG -352 -288 0
FLAG -352 -400 +5V
FLAG 784 208 x1_d
FLAG 1232 144 q1
FLAG 1840 832 0
FLAG -240 176 square
FLAG -240 288 0
FLAG 720 208 square
FLAG 1232 464 q1p
FLAG 1232 608 0
FLAG 1776 352 vsw1
FLAG 1232 288 vsw1
FLAG 2320 688 0
FLAG 1680 688 +VDD
FLAG 1680 416 0
FLAG 1776 832 0
FLAG 1776 752 q1p
SYMBOL voltage -144 -400 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value {VDD}
SYMBOL voltage -336 -400 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 5
SYMBOL bv 1232 176 R0
SYMATTR InstName B1
SYMATTR Value V=IF(V(x1_d), 12, 0)
SYMBOL bv 1232 496 R0
SYMATTR InstName B3
SYMATTR Value V=IF(V(x1_d), 12, 0)
SYMBOL voltage -240 176 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value PULSE(0 {Vp} 0 {1p} {1p} {D*T} {T})
SYMBOL ind2 1824 544 R0
SYMATTR InstName L2
SYMATTR Value 100µH
SYMATTR Type ind
SYMBOL ind2 2080 544 M0
SYMATTR InstName L3
SYMATTR Value 250mH
SYMATTR Type ind
SYMBOL ind 2336 544 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 2.88mH
SYMBOL diode 2208 544 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value Dideal
SYMBOL diode 2336 624 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMATTR Value Dideal
SYMBOL cap 2480 560 R0
SYMATTR InstName C3
SYMATTR Value 100µF
SYMATTR SpiceLine IC=240
SYMBOL res 2656 544 R0
SYMATTR InstName R3
SYMATTR Value 240
SYMBOL diode 1776 672 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMATTR Value Dideal
SYMBOL diode 1712 432 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D5
SYMATTR Value Dideal
SYMBOL sw 1840 832 M180
SYMATTR InstName S1
SYMATTR Value Switch
SYMBOL sw 1840 352 M180
SYMATTR InstName S2
SYMATTR Value Switch
SYMBOL ind 1824 432 R0
SYMATTR InstName L4
SYMATTR Value 0.24µH
TEXT -392 -640 Left 2 !.param f 100k\n.param T 1/f\n.param D 0.4\n.param Vp 1V\n.param VDD 12V
TEXT 2440 -656 Left 2 !.tran 0 100m 0
TEXT 416 -632 Left 2 !.options gmin=1e-10\n.options abstol=1e-10\n.options reltol=0.001\n.options cshunt=1e-15
TEXT -464 -680 Left 4 ;Parameters and Voltage Supplies
TEXT 1120 16 Left 4 ;Gate Driver
TEXT 1528 32 Left 4 ;H-Bridge and sample buck converter
TEXT -376 8 Left 4 ;Triangle/Sawtooth/Square
TEXT 400 -680 Left 4 ;Some commands to make simulation converge
TEXT 1512 -672 Left 4 ;Subcircuits
TEXT 1512 -616 Left 2 !.lib LM358.sub\n.lib LM339.sub\n.model DL1A D(Ron=1u Vfwd=0 Roff=100g ilimit=1)\n.model DL2A D(Ron=1u Vfwd=0 Roff=100g ilimit=2)\n.model DL5A D(Ron=1u Vfwd=0 Roff=100g ilimit=5)\n.model Dideal D(Ron=1u Roff=1Meg Vfwd=0)\n.model Switch SW(Roff=100Meg Ron=1u Vt=0.5 Vh=0)
TEXT 2176 -616 Left 2 ;<= Op-amp\n<= Comparator\n<= 1A current limiter\n<= 2A current limiter\n<= 5A current limiter
TEXT 1552 80 Left 2 !.param RG 10
TEXT 1968 456 Left 2 !K1 L2 L3 1
